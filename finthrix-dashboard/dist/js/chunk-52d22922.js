var e=Object.defineProperty,t=(t,a,s)=>(((t,a,s)=>{a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s})(t,"symbol"!=typeof a?a+"":a,s),s);import{j as a}from"./chunk-443b1647.js";import{r as s}from"./chunk-297699a5.js";import{E as r,u as o,w as n,h as i,a as l}from"./chunk-ae248513.js";import{F as c,U as d,D as m,C as h,a as u,T as p,S as x,E as g,R as b,b as f,B as y,c as j,L as v,P as N,I as w,d as C,e as k}from"./chunk-fa9c0daf.js";class S{constructor(e={}){t(this,"cache",new Map),t(this,"defaultTTL",3e5),t(this,"maxSize",100),this.defaultTTL=e.ttl||this.defaultTTL,this.maxSize=e.maxSize||this.maxSize}set(e,t,a){const s=Date.now(),r=a||this.defaultTTL;if(this.cleanup(),this.cache.size>=this.maxSize){const e=this.getOldestKey();e&&this.cache.delete(e)}const o={data:t,timestamp:s,expiresAt:s+r,key:e};this.cache.set(e,o)}get(e){const t=this.cache.get(e);return t?Date.now()>t.expiresAt?(this.cache.delete(e),null):t.data:null}has(e){const t=this.cache.get(e);return!!t&&(!(Date.now()>t.expiresAt)||(this.cache.delete(e),!1))}delete(e){return this.cache.delete(e)}clear(){this.cache.clear()}cleanup(){const e=Date.now(),t=[];this.cache.forEach((a,s)=>{e>a.expiresAt&&t.push(s)}),t.forEach(e=>this.cache.delete(e))}getStats(){return this.cleanup(),{size:this.cache.size,maxSize:this.maxSize,items:Array.from(this.cache.values()).map(e=>({key:e.key,timestamp:e.timestamp,expiresAt:e.expiresAt,age:Date.now()-e.timestamp}))}}getOldestKey(){let e=null,t=1/0;return this.cache.forEach((a,s)=>{a.timestamp<t&&(t=a.timestamp,e=s)}),e}generateKey(e,t){return`${e}:${Object.keys(t).sort().map(e=>`${e}:${JSON.stringify(t[e])}`).join("|")}`}}const T=new S({ttl:6e5,maxSize:50});new S({ttl:12e4,maxSize:20});const P=new class{async exportToPDF(e,t={}){const{includeCharts:a=!0,includeTransactions:s=!0,includeAccountsPayable:o=!0,includeKPIs:n=!0,fileName:i=`finthrix-relatorio-${(new Date).toISOString().split("T")[0]}`}=t;try{const t=new r("p","mm","a4"),l=t.internal.pageSize.getWidth(),c=t.internal.pageSize.getHeight();let d=20;if(t.setFontSize(20),t.setFont("helvetica","bold"),t.text("FinThrix - Relatório Financeiro",l/2,d,{align:"center"}),d+=10,t.setFontSize(12),t.setFont("helvetica","normal"),t.text(`Período: ${e.period}`,l/2,d,{align:"center"}),d+=5,t.text(`Gerado em: ${e.generatedAt}`,l/2,d,{align:"center"}),d+=20,n){t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Indicadores Principais",20,d),d+=10,t.setFontSize(12),t.setFont("helvetica","normal");[["Saldo Atual",this.formatCurrency(e.kpis.currentBalance)],["Total de Entradas",this.formatCurrency(e.kpis.totalIncome)],["Total de Saídas",this.formatCurrency(e.kpis.totalExpenses)],["Contas a Pagar",this.formatCurrency(e.kpis.accountsPayable)],["Contas Vencidas",this.formatCurrency(e.kpis.overdueAccounts)]].forEach(([e,a])=>{t.text(`${e}: ${a}`,20,d),d+=7}),d+=10}a&&(await this.addChartsToPDF(t,d),d+=100),d>c-50&&(t.addPage(),d=20),s&&e.transactions.length>0&&(t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Transações Recentes",20,d),d+=10,t.setFontSize(10),t.setFont("helvetica","normal"),t.text("Data",20,d),t.text("Descrição",50,d),t.text("Categoria",120,d),t.text("Valor",160,d),d+=7,t.line(20,d-2,190,d-2),e.transactions.slice(0,15).forEach(e=>{d>c-20&&(t.addPage(),d=20);const a=new Date(e.date).toLocaleDateString("pt-BR"),s="income"===e.type?"+":"-";t.text(a,20,d),t.text(e.description.substring(0,25),50,d),t.text(e.category,120,d),t.text(`${s}${this.formatCurrency(e.amount)}`,160,d),d+=6}),d+=10),o&&e.accountsPayable.length>0&&(d>c-50&&(t.addPage(),d=20),t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Contas a Pagar",20,d),d+=10,t.setFontSize(10),t.setFont("helvetica","normal"),t.text("Vencimento",20,d),t.text("Descrição",60,d),t.text("Categoria",120,d),t.text("Valor",160,d),t.text("Status",180,d),d+=7,t.line(20,d-2,190,d-2),e.accountsPayable.forEach(e=>{d>c-20&&(t.addPage(),d=20);const a=new Date(e.dueDate).toLocaleDateString("pt-BR"),s="pending"===e.status?"Pendente":"paid"===e.status?"Paga":"Vencida";t.text(a,20,d),t.text(e.description.substring(0,20),60,d),t.text(e.category,120,d),t.text(this.formatCurrency(e.amount),160,d),t.text(s,180,d),d+=6}));const m=t.internal.getNumberOfPages();for(let e=1;e<=m;e++)t.setPage(e),t.setFontSize(8),t.text(`Página ${e} de ${m}`,l-30,c-10),t.text("Gerado por FinThrix Dashboard",20,c-10);t.save(`${i}.pdf`)}catch(l){throw new Error("Falha ao gerar relatório em PDF")}}async exportToExcel(e,t={}){const{includeTransactions:a=!0,includeAccountsPayable:s=!0,includeKPIs:r=!0,fileName:i=`finthrix-dados-${(new Date).toISOString().split("T")[0]}`}=t;try{const t=o.book_new();if(r){const a=[["Indicador","Valor"],["Saldo Atual",e.kpis.currentBalance],["Total de Entradas",e.kpis.totalIncome],["Total de Saídas",e.kpis.totalExpenses],["Contas a Pagar",e.kpis.accountsPayable],["Contas Vencidas",e.kpis.overdueAccounts],[],["Período",e.period],["Gerado em",e.generatedAt]],s=o.aoa_to_sheet(a);o.book_append_sheet(t,s,"KPIs")}if(a&&e.transactions.length>0){const a=[["Data","Descrição","Categoria","Tipo","Valor","Status"],...e.transactions.map(e=>[new Date(e.date).toLocaleDateString("pt-BR"),e.description,e.category,"income"===e.type?"Entrada":"Saída",e.amount,"completed"===e.status?"Concluída":"Pendente"])],s=o.aoa_to_sheet(a);o.book_append_sheet(t,s,"Transações")}if(s&&e.accountsPayable.length>0){const a=[["Vencimento","Descrição","Categoria","Valor","Status"],...e.accountsPayable.map(e=>[new Date(e.dueDate).toLocaleDateString("pt-BR"),e.description,e.category,e.amount,"pending"===e.status?"Pendente":"paid"===e.status?"Paga":"Vencida"])],s=o.aoa_to_sheet(a);o.book_append_sheet(t,s,"Contas a Pagar")}n(t,`${i}.xlsx`)}catch(l){throw new Error("Falha ao gerar arquivo Excel")}}async addChartsToPDF(e,t){try{const a=document.querySelector("[data-charts-container]");if(!a)return;const s=await i(a,{scale:1,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff"}),r=s.toDataURL("image/png"),o=170,n=s.height*o/s.width;e.addImage(r,"PNG",20,t,o,n)}catch(a){}}formatCurrency(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}prepareExportData(e,t,a,s="Último mês"){return{kpis:e,transactions:t,accountsPayable:a,period:s,generatedAt:(new Date).toLocaleString("pt-BR")}}async exportWithCache(e,t={}){const a=T.generateKey("export",{format:t.format||"pdf",includeCharts:t.includeCharts,includeTransactions:t.includeTransactions,includeAccountsPayable:t.includeAccountsPayable,includeKPIs:t.includeKPIs,dataHash:this.generateDataHash(e)}),s=T.get(a);if(s)this.downloadBlob(s,t.fileName||"cached-export");else if("excel"===t.format){const s=await this.generateExcelBlob(e,t);T.set(a,s),this.downloadBlob(s,t.fileName||"export.xlsx")}else await this.exportToPDF(e,t)}generateDataHash(e){const t=JSON.stringify({kpisCount:Object.keys(e.kpis).length,transactionsCount:e.transactions.length,accountsPayableCount:e.accountsPayable.length,period:e.period});let a=0;for(let s=0;s<t.length;s++){a=(a<<5)-a+t.charCodeAt(s),a&=a}return a.toString()}async generateExcelBlob(e,t){const a=o.book_new();if(!1!==t.includeKPIs){const t=[["Métrica","Valor"],["Receita Total",this.formatCurrency(e.kpis.totalRevenue)],["Despesas Totais",this.formatCurrency(e.kpis.totalExpenses)],["Lucro Líquido",this.formatCurrency(e.kpis.netProfit)],["Contas a Pagar",this.formatCurrency(e.kpis.accountsPayable)],["Contas Vencidas",this.formatCurrency(e.kpis.overdueAccounts)]],s=o.aoa_to_sheet(t);o.book_append_sheet(a,s,"KPIs")}if(!1!==t.includeTransactions&&e.transactions.length>0){const t=[["Data","Descrição","Categoria","Tipo","Valor"],...e.transactions.map(e=>[new Date(e.date).toLocaleDateString("pt-BR"),e.description,e.category,"income"===e.type?"Receita":"Despesa",this.formatCurrency(e.amount)])],s=o.aoa_to_sheet(t);o.book_append_sheet(a,s,"Transações")}if(!1!==t.includeAccountsPayable&&e.accountsPayable.length>0){const t=[["Descrição","Valor","Data de Vencimento","Status"],...e.accountsPayable.map(e=>[e.description,this.formatCurrency(e.amount),new Date(e.dueDate).toLocaleDateString("pt-BR"),"pending"===e.status?"Pendente":"paid"===e.status?"Pago":"Vencido"])],s=o.aoa_to_sheet(t);o.book_append_sheet(a,s,"Contas a Pagar")}const s=l(a,{bookType:"xlsx",type:"array"});return new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}downloadBlob(e,t){const a=URL.createObjectURL(e),s=document.createElement("a");s.href=a,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}async exportToCSV(e,t={}){const{includeTransactions:a=!0,includeAccountsPayable:s=!0,includeKPIs:r=!0,fileName:o=`finthrix-dados-${(new Date).toISOString().split("T")[0]}`,csvOptions:n={}}=t,{delimiter:i=",",includeHeaders:l=!0,encoding:c="utf-8"}=n;try{let t="";l&&(t+="# FinThrix - Exportação de Dados\n",t+=`# Período: ${e.period}\n`,t+=`# Gerado em: ${e.generatedAt}\n`,t+="\n"),r&&(l&&(t+="# INDICADORES (KPIs)\n",t+=`Indicador${i}Valor\n`),t+=`Receita Total${i}${this.formatCurrency(e.kpis.totalRevenue)}\n`,t+=`Despesas Totais${i}${this.formatCurrency(e.kpis.totalExpenses)}\n`,t+=`Lucro Líquido${i}${this.formatCurrency(e.kpis.netProfit)}\n`,t+=`Contas a Pagar${i}${this.formatCurrency(e.kpis.accountsPayable)}\n`,t+=`Contas Vencidas${i}${this.formatCurrency(e.kpis.overdueAccounts)}\n`,t+="\n"),a&&e.transactions.length>0&&(l&&(t+="# TRANSAÇÕES\n",t+=`Data${i}Descrição${i}Categoria${i}Tipo${i}Valor\n`),e.transactions.forEach(e=>{const a=new Date(e.date).toLocaleDateString("pt-BR"),s="income"===e.type?"Receita":"Despesa",r=this.formatCurrency(e.amount);t+=`${a}${i}"${e.description}"${i}${e.category}${i}${s}${i}${r}\n`}),t+="\n"),s&&e.accountsPayable.length>0&&(l&&(t+="# CONTAS A PAGAR\n",t+=`Descrição${i}Valor${i}Data de Vencimento${i}Status\n`),e.accountsPayable.forEach(e=>{const a=new Date(e.dueDate).toLocaleDateString("pt-BR"),s="pending"===e.status?"Pendente":"paid"===e.status?"Pago":"Vencido",r=this.formatCurrency(e.amount);t+=`"${e.description}"${i}${r}${i}${a}${i}${s}\n`}));const n=new Blob([t],{type:`text/csv;charset=${c}`});this.downloadBlob(n,`${o}.csv`)}catch(d){throw new Error("Falha na exportação para CSV")}}async exportToJSON(e,t={}){const{includeTransactions:a=!0,includeAccountsPayable:s=!0,includeKPIs:r=!0,fileName:o=`finthrix-dados-${(new Date).toISOString().split("T")[0]}`,jsonOptions:n={}}=t,{pretty:i=!0,includeMetadata:l=!0}=n;try{const t={};l&&(t.metadata={exportedAt:(new Date).toISOString(),period:e.period,generatedAt:e.generatedAt,version:"1.0",source:"FinThrix Dashboard"}),r&&(t.kpis={totalRevenue:{value:e.kpis.totalRevenue,formatted:this.formatCurrency(e.kpis.totalRevenue),description:"Receita total do período"},totalExpenses:{value:e.kpis.totalExpenses,formatted:this.formatCurrency(e.kpis.totalExpenses),description:"Despesas totais do período"},netProfit:{value:e.kpis.netProfit,formatted:this.formatCurrency(e.kpis.netProfit),description:"Lucro líquido do período"},accountsPayable:{value:e.kpis.accountsPayable,formatted:this.formatCurrency(e.kpis.accountsPayable),description:"Total de contas a pagar"},overdueAccounts:{value:e.kpis.overdueAccounts,formatted:this.formatCurrency(e.kpis.overdueAccounts),description:"Total de contas vencidas"}}),a&&e.transactions.length>0&&(t.transactions=e.transactions.map(e=>({id:e.id,date:e.date,dateFormatted:new Date(e.date).toLocaleDateString("pt-BR"),description:e.description,category:e.category,type:e.type,typeLabel:"income"===e.type?"Receita":"Despesa",amount:e.amount,amountFormatted:this.formatCurrency(e.amount)}))),s&&e.accountsPayable.length>0&&(t.accountsPayable=e.accountsPayable.map(e=>({id:e.id,description:e.description,amount:e.amount,amountFormatted:this.formatCurrency(e.amount),dueDate:e.dueDate,dueDateFormatted:new Date(e.dueDate).toLocaleDateString("pt-BR"),status:e.status,statusLabel:"pending"===e.status?"Pendente":"paid"===e.status?"Pago":"Vencido",isOverdue:new Date(e.dueDate)<new Date&&"paid"!==e.status}))),l&&(t.summary={totalTransactions:e.transactions.length,totalAccountsPayable:e.accountsPayable.length,overdueAccountsCount:e.accountsPayable.filter(e=>new Date(e.dueDate)<new Date&&"paid"!==e.status).length,incomeTransactions:e.transactions.filter(e=>"income"===e.type).length,expenseTransactions:e.transactions.filter(e=>"expense"===e.type).length});const n=i?JSON.stringify(t,null,2):JSON.stringify(t),c=new Blob([n],{type:"application/json;charset=utf-8"});this.downloadBlob(c,`${o}.json`)}catch(c){throw new Error("Falha na exportação para JSON")}}async export(e,t){try{switch(t.format){case"pdf":await this.exportToPDF(e,t);break;case"excel":await this.exportToExcel(e,t);break;case"csv":await this.exportToCSV(e,t);break;case"json":await this.exportToJSON(e,t);break;default:throw new Error(`Formato de exportação não suportado: ${t.format}`)}}catch(a){throw a}}clearExportCache(){T.clear()}getCacheStats(){return T.getStats()}},D=[{id:"executive",name:"Executivo",description:"Template limpo e profissional para relatórios executivos",config:{orientation:"portrait",format:"a4",margins:{top:20,right:20,bottom:20,left:20},header:{enabled:!0,height:60,showLogo:!0,showTitle:!0,showDate:!0,backgroundColor:"#1f2937",textColor:"#ffffff",fontSize:16},footer:{enabled:!0,height:40,showPageNumbers:!0,showCompanyInfo:!0,backgroundColor:"#f9fafb",textColor:"#6b7280",fontSize:10},content:{showKPIs:!0,showCharts:!0,chartsPerRow:2,chartHeight:200,showDataTable:!1,fontSize:12,lineHeight:1.5},colors:{primary:"#3b82f6",secondary:"#64748b",accent:"#10b981",text:"#1f2937",background:"#ffffff",border:"#e5e7eb"},branding:{companyName:"FinThrix",companyAddress:"São Paulo, SP",companyEmail:"contato@finthrix.com"}}},{id:"detailed",name:"Detalhado",description:"Template completo com todos os dados e gráficos",config:{orientation:"landscape",format:"a4",margins:{top:15,right:15,bottom:15,left:15},header:{enabled:!0,height:50,showLogo:!0,showTitle:!0,showDate:!0,backgroundColor:"#059669",textColor:"#ffffff",fontSize:14},footer:{enabled:!0,height:30,showPageNumbers:!0,showCompanyInfo:!1,backgroundColor:"#ffffff",textColor:"#374151",fontSize:9},content:{showKPIs:!0,showCharts:!0,chartsPerRow:2,chartHeight:180,showDataTable:!0,fontSize:10,lineHeight:1.4},colors:{primary:"#059669",secondary:"#6b7280",accent:"#f59e0b",text:"#374151",background:"#ffffff",border:"#d1d5db"},branding:{companyName:"FinThrix Analytics",companyAddress:"São Paulo, SP - Brasil",companyPhone:"+55 (11) 9999-9999",companyEmail:"analytics@finthrix.com"}}},{id:"minimal",name:"Minimalista",description:"Template simples focado apenas nos dados essenciais",config:{orientation:"portrait",format:"a4",margins:{top:30,right:30,bottom:30,left:30},header:{enabled:!1,height:0,showLogo:!1,showTitle:!1,showDate:!1,backgroundColor:"#ffffff",textColor:"#000000",fontSize:12},footer:{enabled:!1,height:0,showPageNumbers:!1,showCompanyInfo:!1,backgroundColor:"#ffffff",textColor:"#6b7280",fontSize:8},content:{showKPIs:!0,showCharts:!0,chartsPerRow:1,chartHeight:250,showDataTable:!1,fontSize:14,lineHeight:1.6},colors:{primary:"#000000",secondary:"#6b7280",accent:"#3b82f6",text:"#000000",background:"#ffffff",border:"#e5e7eb"},branding:{companyName:"Dashboard Report"}}}];const $=new class{constructor(){t(this,"templates",[...D]),t(this,"storageKey","finthrix_pdf_templates"),this.loadTemplatesFromStorage()}loadTemplatesFromStorage(){try{const e=localStorage.getItem(this.storageKey);if(e){const t=JSON.parse(e);this.templates=[...D,...t.filter(e=>!D.some(t=>t.id===e.id))]}}catch(e){}}saveTemplatesToStorage(){try{const e=this.templates.filter(e=>!D.some(t=>t.id===e.id));localStorage.setItem(this.storageKey,JSON.stringify(e))}catch(e){}}getAllTemplates(){return[...this.templates]}getTemplateById(e){return this.templates.find(t=>t.id===e)}createTemplate(e){const t={...e,id:`custom_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};return this.templates.push(t),this.saveTemplatesToStorage(),t}updateTemplate(e,t){const a=this.templates.findIndex(t=>t.id===e);if(-1===a)return null;if(D.some(t=>t.id===e))throw new Error("Templates padrão não podem ser editados");return this.templates[a]={...this.templates[a],...t},this.saveTemplatesToStorage(),this.templates[a]}deleteTemplate(e){if(D.some(t=>t.id===e))throw new Error("Templates padrão não podem ser removidos");const t=this.templates.findIndex(t=>t.id===e);return-1!==t&&(this.templates.splice(t,1),this.saveTemplatesToStorage(),!0)}duplicateTemplate(e,t){const a=this.getTemplateById(e);if(!a)return null;return this.createTemplate({name:t||`${a.name} (Cópia)`,description:`Cópia de ${a.description}`,preview:a.preview,config:JSON.parse(JSON.stringify(a.config))})}validateTemplate(e){const t=[];if(e.name&&0!==e.name.trim().length||t.push("Nome do template é obrigatório"),!e.config)return t.push("Configuração do template é obrigatória"),{isValid:!1,errors:t};const{config:a}=e;(a.margins.top<0||a.margins.right<0||a.margins.bottom<0||a.margins.left<0)&&t.push("Margens não podem ser negativas");const s=/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/;return Object.entries(a.colors).forEach(([e,a])=>{s.test(a)||t.push(`Cor ${e} inválida: ${a}`)}),(a.header.fontSize<8||a.header.fontSize>24)&&t.push("Tamanho da fonte do cabeçalho deve estar entre 8 e 24"),(a.footer.fontSize<6||a.footer.fontSize>16)&&t.push("Tamanho da fonte do rodapé deve estar entre 6 e 16"),(a.content.fontSize<8||a.content.fontSize>20)&&t.push("Tamanho da fonte do conteúdo deve estar entre 8 e 20"),{isValid:0===t.length,errors:t}}exportTemplates(e){const t=e?this.templates.filter(t=>e.includes(t.id)):this.templates.filter(e=>!D.some(t=>t.id===e.id));return JSON.stringify(t,null,2)}importTemplates(e){const t=[];let a=0;try{const s=JSON.parse(e);if(!Array.isArray(s))throw new Error("Dados devem ser um array de templates");s.forEach((e,s)=>{try{const r=this.validateTemplate(e);if(!r.isValid)return void t.push(`Template ${s+1}: ${r.errors.join(", ")}`);const o={...e,id:`imported_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};this.templates.push(o),a++}catch(r){t.push(`Template ${s+1}: ${r instanceof Error?r.message:"Erro desconhecido"}`)}}),a>0&&this.saveTemplatesToStorage()}catch(s){t.push(`Erro ao processar JSON: ${s instanceof Error?s.message:"Erro desconhecido"}`)}return{success:a,errors:t}}resetToDefaults(){this.templates=[...D],localStorage.removeItem(this.storageKey)}},E=({selectedTemplateId:e,onTemplateSelect:t,onClose:r})=>{const[o,n]=s.useState([]),[i,l]=s.useState(null),[x,g]=s.useState(!0);s.useEffect(()=>{b()},[]),s.useEffect(()=>{if(e){const t=o.find(t=>t.id===e);t&&l(t)}},[e,o]);const b=()=>{g(!0);try{const e=$.getAllTemplates();n(e)}catch(e){}finally{g(!1)}};return x?a.jsx("div",{className:"flex items-center justify-center p-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-4xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(c,{className:"h-6 w-6 text-blue-600"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Selecionar Template PDF"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("label",{className:"cursor-pointer p-2 text-gray-500 hover:text-blue-600 rounded-lg hover:bg-gray-100",children:[a.jsx(d,{className:"h-5 w-5"}),a.jsx("input",{type:"file",accept:".json",onChange:e=>{var t;const a=null==(t=e.target.files)?void 0:t[0];if(!a)return;const s=new FileReader;s.onload=e=>{var t;try{const a=null==(t=e.target)?void 0:t.result,s=$.importTemplates(a);s.success>0&&(alert(`${s.success} template(s) importado(s) com sucesso!`),b()),s.errors.length>0&&alert(`Erros encontrados:\n${s.errors.join("\n")}`)}catch(a){alert("Erro ao importar templates. Verifique o formato do arquivo.")}},s.readAsText(a),e.target.value=""},className:"hidden"})]}),a.jsx("button",{onClick:()=>{try{const e=o.filter(e=>!e.id.startsWith("executive")&&!e.id.startsWith("detailed")&&!e.id.startsWith("minimal"));if(0===e.length)return void alert("Nenhum template customizado para exportar");const t=$.exportTemplates(e.map(e=>e.id)),a=new Blob([t],{type:"application/json"}),s=URL.createObjectURL(a),r=document.createElement("a");r.href=s,r.download=`finthrix-templates-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s)}catch(e){}},className:"p-2 text-gray-500 hover:text-blue-600 rounded-lg hover:bg-gray-100",title:"Exportar templates customizados",children:a.jsx(m,{className:"h-5 w-5"})}),r&&a.jsx("button",{onClick:r,className:"p-2 text-gray-500 hover:text-red-600 rounded-lg hover:bg-gray-100",children:"✕"})]})]}),a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(e=>a.jsxs("div",{className:"relative border-2 rounded-lg p-4 cursor-pointer transition-all "+((null==i?void 0:i.id)===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),onClick:()=>(e=>{l(e),t(e)})(e),children:[(null==i?void 0:i.id)===e.id&&a.jsx("div",{className:"absolute top-2 right-2 bg-blue-500 text-white rounded-full p-1",children:a.jsx(h,{className:"h-4 w-4"})}),a.jsx("div",{className:"mb-3",children:a.jsx("div",{className:"w-full h-32 rounded border-2 border-dashed border-gray-300 flex items-center justify-center",style:{backgroundColor:e.config.colors.background},children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-xs font-medium mb-1",style:{color:e.config.colors.primary},children:"landscape"===e.config.orientation?"📄":"📋"}),a.jsx("div",{className:"text-xs text-gray-500",children:e.config.format.toUpperCase()})]})})}),a.jsxs("div",{className:"mb-3",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:e.name}),a.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:e.description})]}),a.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[e.config.header.enabled&&a.jsx("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:"Cabeçalho"}),e.config.footer.enabled&&a.jsx("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:"Rodapé"}),e.config.content.showCharts&&a.jsx("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:"Gráficos"}),e.config.content.showDataTable&&a.jsx("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:"Tabelas"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("button",{onClick:t=>{t.stopPropagation(),(async e=>{try{$.duplicateTemplate(e.id)&&b()}catch(t){}})(e)},className:"p-1 text-gray-400 hover:text-blue-600 rounded",title:"Duplicar template",children:a.jsx(u,{className:"h-4 w-4"})}),!e.id.startsWith("executive")&&!e.id.startsWith("detailed")&&!e.id.startsWith("minimal")&&a.jsx("button",{onClick:t=>{t.stopPropagation(),(async e=>{if(window.confirm("Tem certeza que deseja excluir este template?"))try{$.deleteTemplate(e),b(),(null==i?void 0:i.id)===e&&l(null)}catch(t){alert("Não é possível deletar templates padrão")}})(e.id)},className:"p-1 text-gray-400 hover:text-red-600 rounded",title:"Excluir template",children:a.jsx(p,{className:"h-4 w-4"})})]}),a.jsxs("span",{className:"text-xs text-gray-500",children:[e.config.orientation," • ",e.config.format]})]})]},e.id))})}),a.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50",children:[a.jsxs("div",{className:"text-sm text-gray-600",children:[o.length," template(s) disponível(is)"]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[r&&a.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancelar"}),a.jsx("button",{onClick:()=>i&&t(i),disabled:!i,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Usar Template"})]})]})]})},I=({template:e,onSave:t,onCancel:r})=>{const[o,n]=s.useState({...e}),[i,l]=s.useState("layout"),[d,m]=s.useState(!1),h=(e,t)=>{const a=e.split("."),s={...o.config};let r=s;for(let o=0;o<a.length-1;o++)r=r[a[o]];r[a[a.length-1]]=t,n({...o,config:s})},u=[{id:"layout",label:"Layout",icon:v},{id:"content",label:"Conteúdo",icon:c},{id:"style",label:"Estilo",icon:N},{id:"branding",label:"Marca",icon:w}];return a.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-6xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(x,{className:"h-6 w-6 text-blue-600"}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Customizar Template"}),a.jsx("p",{className:"text-sm text-gray-600",children:o.name})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("button",{onClick:()=>m(!d),className:"px-4 py-2 rounded-lg flex items-center space-x-2 "+(d?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[a.jsx(g,{className:"h-4 w-4"}),a.jsx("span",{children:"Preview"})]}),a.jsx("button",{onClick:()=>{window.confirm("Descartar todas as alterações?")&&n({...e})},className:"px-4 py-2 text-gray-600 hover:text-gray-800 rounded-lg hover:bg-gray-100",children:a.jsx(b,{className:"h-4 w-4"})}),a.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancelar"}),a.jsxs("button",{onClick:()=>{try{let e=null;e=o.id&&o.id.startsWith("custom_")?$.updateTemplate(o.id,o):$.createTemplate({name:o.name,description:o.description,preview:o.preview,config:o.config}),e&&t(e)}catch(e){alert("Erro ao salvar template")}},className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[a.jsx(f,{className:"h-4 w-4"}),a.jsx("span",{children:"Salvar"})]})]})]}),a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"w-64 border-r border-gray-200 bg-gray-50",children:a.jsx("div",{className:"p-4",children:a.jsx("nav",{className:"space-y-2",children:u.map(e=>{const t=e.icon;return a.jsxs("button",{onClick:()=>l(e.id),className:"w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-left "+(i===e.id?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-100"),children:[a.jsx(t,{className:"h-5 w-5"}),a.jsx("span",{children:e.label})]},e.id)})})})}),a.jsx("div",{className:"flex-1",children:d?a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"bg-gray-100 rounded-lg p-8",children:a.jsxs("div",{className:"bg-white shadow-lg mx-auto rounded-lg overflow-hidden",style:{width:"landscape"===o.config.orientation?"400px":"300px",height:"landscape"===o.config.orientation?"283px":"400px",backgroundColor:o.config.colors.background},children:[o.config.header.enabled&&a.jsx("div",{className:"p-4 border-b",style:{backgroundColor:o.config.colors.primary,color:o.config.colors.text},children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold text-sm",children:o.config.branding.companyName||"Empresa"}),a.jsx("p",{className:"text-xs opacity-80",children:"Relatório Financeiro"})]}),o.config.branding.companyLogo&&a.jsx("div",{className:"w-8 h-8 bg-white rounded opacity-80"})]})}),a.jsxs("div",{className:"p-4 space-y-3",children:[o.config.content.showCharts&&a.jsxs("div",{className:"text-xs",children:[a.jsxs("h4",{className:"font-medium mb-1 flex items-center",children:[a.jsx(y,{className:"h-3 w-3 mr-1"}),"Gráficos"]}),a.jsx("div",{className:"h-16 bg-gray-100 rounded flex items-center justify-center",children:a.jsx(y,{className:"h-6 w-6 text-gray-400"})})]}),o.config.content.showDataTable&&a.jsxs("div",{className:"text-xs",children:[a.jsxs("h4",{className:"font-medium mb-1 flex items-center",children:[a.jsx(j,{className:"h-3 w-3 mr-1"}),"Dados"]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("div",{className:"h-1 bg-gray-200 rounded"}),a.jsx("div",{className:"h-1 bg-gray-200 rounded w-3/4"}),a.jsx("div",{className:"h-1 bg-gray-200 rounded w-1/2"})]})]})]}),o.config.footer.enabled&&a.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-2 border-t text-xs text-center",style:{color:o.config.colors.secondary},children:["Página 1 • ",(new Date).toLocaleDateString()]})]})})}):a.jsxs("div",{className:"p-6",children:["layout"===i&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Configurações de Layout"}),a.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Formato"}),a.jsxs("select",{value:o.config.format,onChange:e=>h("format",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"a4",children:"A4"}),a.jsx("option",{value:"letter",children:"Letter"}),a.jsx("option",{value:"legal",children:"Legal"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Orientação"}),a.jsxs("select",{value:o.config.orientation,onChange:e=>h("orientation",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"portrait",children:"Retrato"}),a.jsx("option",{value:"landscape",children:"Paisagem"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Margens"}),a.jsx("div",{className:"grid grid-cols-4 gap-4",children:["top","right","bottom","left"].map(e=>a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1 capitalize",children:"top"===e?"Superior":"right"===e?"Direita":"bottom"===e?"Inferior":"Esquerda"}),a.jsx("input",{type:"number",value:o.config.margins[e],onChange:t=>h(`margins.${e}`,parseInt(t.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"0",max:"100"})]},e))})]})]}),"content"===i&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Elementos do Conteúdo"}),a.jsx("div",{className:"space-y-4",children:[{key:"showKPIs",label:"KPIs",desc:"Inclui indicadores chave de performance"},{key:"showCharts",label:"Gráficos",desc:"Inclui visualizações gráficas dos dados"},{key:"showDataTable",label:"Tabela de Dados",desc:"Inclui tabelas detalhadas com os dados"}].map(e=>a.jsxs("div",{className:"flex items-start space-x-3 p-4 border border-gray-200 rounded-lg",children:[a.jsx("input",{type:"checkbox",checked:o.config.content[e.key],onChange:t=>h(`content.${e.key}`,t.target.checked),className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-900",children:e.label}),a.jsx("p",{className:"text-sm text-gray-600",children:e.desc})]})]},e.key))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Cabeçalho e Rodapé"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",checked:o.config.header.enabled,onChange:e=>h("header.enabled",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),a.jsx("label",{className:"text-sm font-medium text-gray-900",children:"Incluir Cabeçalho"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",checked:o.config.footer.enabled,onChange:e=>h("footer.enabled",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),a.jsx("label",{className:"text-sm font-medium text-gray-900",children:"Incluir Rodapé"})]})]})]})]}),"style"===i&&a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Cores e Tipografia"}),a.jsx("div",{className:"grid grid-cols-2 gap-6",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("h4",{className:"text-md font-medium text-gray-900",children:"Cores"}),[{key:"primary",label:"Cor Primária"},{key:"secondary",label:"Cor Secundária"},{key:"accent",label:"Cor de Destaque"},{key:"background",label:"Fundo"},{key:"text",label:"Texto"}].map(e=>a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"color",value:o.config.colors[e.key],onChange:t=>h(`colors.${e.key}`,t.target.value),className:"w-12 h-8 border border-gray-300 rounded cursor-pointer"}),a.jsx("label",{className:"text-sm font-medium text-gray-700",children:e.label})]},e.key))]})})]})}),"branding"===i&&a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Identidade da Marca"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome da Empresa"}),a.jsx("input",{type:"text",value:o.config.branding.companyName,onChange:e=>h("branding.companyName",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Digite o nome da empresa"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Logo da Empresa"}),a.jsx("input",{type:"url",value:o.config.branding.companyLogo||"",onChange:e=>h("branding.companyLogo",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://exemplo.com/logo.png"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Endereço"}),a.jsx("input",{type:"text",value:o.config.branding.companyAddress||"",onChange:e=>h("branding.companyAddress",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Endereço da empresa"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Telefone"}),a.jsx("input",{type:"tel",value:o.config.branding.companyPhone||"",onChange:e=>h("branding.companyPhone",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"+55 (11) 9999-9999"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),a.jsx("input",{type:"email",value:o.config.branding.companyEmail||"",onChange:e=>h("branding.companyEmail",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"contato@empresa.com"})]})]})]})})]})})]})]})},F=({data:e,className:t="",variant:r="primary",size:o="md"})=>{var n,i,l,d;const[h,u]=s.useState(!1),[p,g]=s.useState(!1),[b,f]=s.useState(!1),[y,j]=s.useState(!1),[v,N]=s.useState(null),[w,S]=s.useState({includeCharts:!0,includeTransactions:!0,includeAccountsPayable:!0,includeKPIs:!0,format:"pdf"}),T=e=>{S(t=>({...t,[e]:!t[e]}))};return a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>g(!p),disabled:h,className:`inline-flex items-center justify-center font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed ${{primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-blue-500"}[r]} ${{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[o]} ${t}`,children:[h?a.jsx(C,{className:"w-4 h-4 mr-2 animate-spin"}):a.jsx(m,{className:"w-4 h-4 mr-2"}),h?"Exportando...":"Exportar Relatório"]}),p&&a.jsx("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:a.jsxs("div",{className:"p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Opções de Exportação"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Formato"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("button",{onClick:()=>S(e=>({...e,format:"pdf"})),className:"flex items-center justify-center px-3 py-2 rounded-md border text-sm font-medium transition-colors "+("pdf"===w.format?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50"),children:[a.jsx(c,{className:"w-4 h-4 mr-2"}),"PDF"]}),a.jsxs("button",{onClick:()=>S(e=>({...e,format:"excel"})),className:"flex items-center justify-center px-3 py-2 rounded-md border text-sm font-medium transition-colors "+("excel"===w.format?"border-green-500 bg-green-50 text-green-700":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50"),children:[a.jsx(k,{className:"w-4 h-4 mr-2"}),"Excel"]}),a.jsxs("button",{onClick:()=>S(e=>({...e,format:"csv"})),className:"flex items-center justify-center px-3 py-2 rounded-md border text-sm font-medium transition-colors "+("csv"===w.format?"border-orange-500 bg-orange-50 text-orange-700":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50"),children:[a.jsx(k,{className:"w-4 h-4 mr-2"}),"CSV"]}),a.jsxs("button",{onClick:()=>S(e=>({...e,format:"json"})),className:"flex items-center justify-center px-3 py-2 rounded-md border text-sm font-medium transition-colors "+("json"===w.format?"border-purple-500 bg-purple-50 text-purple-700":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50"),children:[a.jsx(c,{className:"w-4 h-4 mr-2"}),"JSON"]})]})]}),"pdf"===w.format&&a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Template PDF"}),a.jsx("div",{className:"space-y-2",children:a.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg bg-gray-50",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(c,{className:"w-5 h-5 text-gray-500"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:v?v.name:"Template Padrão"}),a.jsx("p",{className:"text-xs text-gray-600",children:v?v.description:"Usar template padrão do sistema"})]})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("button",{onClick:()=>{f(!0),g(!1)},className:"p-2 text-gray-500 hover:text-blue-600 rounded-lg hover:bg-white",title:"Selecionar template",children:a.jsx(x,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>{v?(j(!0),g(!1)):(f(!0),g(!1))},className:"p-2 text-gray-500 hover:text-purple-600 rounded-lg hover:bg-white",title:"Customizar template",children:a.jsx(x,{className:"w-4 h-4"})})]})]})})]}),"csv"===w.format&&a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Configurações CSV"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:!1!==(null==(n=w.csvOptions)?void 0:n.includeHeaders),onChange:e=>S(t=>({...t,csvOptions:{...t.csvOptions,includeHeaders:e.target.checked}})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Incluir cabeçalhos"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("label",{className:"text-sm text-gray-700",children:"Separador:"}),a.jsxs("select",{value:(null==(i=w.csvOptions)?void 0:i.delimiter)||",",onChange:e=>S(t=>({...t,csvOptions:{...t.csvOptions,delimiter:e.target.value}})),className:"text-sm border border-gray-300 rounded px-2 py-1",children:[a.jsx("option",{value:",",children:"Vírgula (,)"}),a.jsx("option",{value:";",children:"Ponto e vírgula (;)"}),a.jsx("option",{value:"\\t",children:"Tab"})]})]})]})]}),"json"===w.format&&a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Configurações JSON"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:!1!==(null==(l=w.jsonOptions)?void 0:l.pretty),onChange:e=>S(t=>({...t,jsonOptions:{...t.jsonOptions,pretty:e.target.checked}})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Formatação legível"})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:!1!==(null==(d=w.jsonOptions)?void 0:d.includeMetadata),onChange:e=>S(t=>({...t,jsonOptions:{...t.jsonOptions,includeMetadata:e.target.checked}})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Incluir metadados"})]})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Incluir no Relatório"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:w.includeKPIs,onChange:()=>T("includeKPIs"),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Indicadores (KPIs)"})]}),"pdf"===w.format&&a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:w.includeCharts,onChange:()=>T("includeCharts"),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Gráficos"})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:w.includeTransactions,onChange:()=>T("includeTransactions"),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Transações"})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:w.includeAccountsPayable,onChange:()=>T("includeAccountsPayable"),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Contas a Pagar"})]})]})]}),a.jsxs("div",{className:"flex justify-between pt-4 border-t border-gray-200",children:[a.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancelar"}),a.jsx("button",{onClick:async()=>{u(!0);try{const t={...w,pdfTemplate:"pdf"===w.format&&v?v:void 0};await P.export(e,t)}catch(t){alert("Erro ao exportar relatório. Tente novamente.")}finally{u(!1),g(!1)}},disabled:h,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:h?a.jsxs(a.Fragment,{children:[a.jsx(C,{className:"w-4 h-4 mr-2 animate-spin"}),"Exportando..."]}):a.jsxs(a.Fragment,{children:[a.jsx(m,{className:"w-4 h-4 mr-2"}),"Exportar ","pdf"===w.format?"PDF":"Excel"]})})]})]})}),p&&a.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>g(!1)}),b&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:a.jsx("div",{className:"max-w-4xl w-full mx-4",children:a.jsx(E,{selectedTemplateId:null==v?void 0:v.id,onTemplateSelect:e=>{N(e),f(!1)},onClose:()=>f(!1)})})}),y&&v&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:a.jsx("div",{className:"max-w-6xl w-full mx-4",children:a.jsx(I,{template:v,onSave:e=>{N(e),j(!1)},onCancel:()=>j(!1)})})})]})};export{F as E};
//# sourceMappingURL=chunk-52d22922.js.map
